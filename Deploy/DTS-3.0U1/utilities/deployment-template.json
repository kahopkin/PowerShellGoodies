{
    "solutionVersion": "3.0",
    "solutionOwner": "Cloud Engineering",
    "solutionName": "[-SOLUTIONNAME-]",
    "subscriptionName": "[-SUBSCRIPTIONNAME-]",
    "location": "[-LOCATION-]",
    "resourceGroupName": "[-SOLUTIONNAME-]-rg",
    "cloudEnvironment" : "AzureUSGovernment",
    "managedUserName": "id-[-SOLUTIONNAME-]",
    "appRegistration": {
    },
    "appService": {
        "plans": [
            {
                "name": "asp-[-SOLUTIONNAME-]-linux",
                "tier": "Standard",
                "size": "S1",
                "osType": "Linux",
                "reserved": true
            },
            {
                "name": "asp-[-SOLUTIONNAME-]-windows",
                "tier": "Standard",
                "size": "S1",
                "osType": "Windows",
                "reserved": false
            }
        ],
        "webApp": {
            "name": "app-[-SOLUTIONNAME-]-web",
            "plan": "asp-[-SOLUTIONNAME-]-linux",
            "runtimeStack": "NODE|14-lts",
            "environmentVariables": [
                {
                    "name": "MY_ENV_VARIABLE",
                    "value": "test"
                }
            ],
            "privateEndpointName": "pe-webapp-[-SOLUTIONNAME-]",
            "privateDnsName": "privatelink-webapp-[-SOLUTIONNAME-].privatelink.azurewebsites.us"
        }
    },
    "functionApps": [
        {
            "name": "workers-[-SOLUTIONNAME-]",
            "appServicePlanName": "asp-[-SOLUTIONNAME-]-windows",
            "suffix": "core.usgovcloudapi.net",
            "storageAccountName": "main[-SOLUTIONNAME-]",
            "privateEndpointName": "pep-func-[-SOLUTIONNAME-]",
            "settings": [
            ]
        }
    ],
    "identity": {
        "name": "id-[-SOLUTIONNAME-]"
    },
    "logAnalytics": {
        "workspaceName": "la-[-SOLUTIONNAME-]",
        "sku": "PerGB2018",
        "retentionInDays": 30
    },
    "sqlServer": {
        "name": "sql-[-SOLUTIONNAME-]",
        "sqlAdminName": "sqlAdmin",
        "privateDnsName": "privatelink-sql-[-SOLUTIONNAME-].database.[-SUFFIX-]",
        "privateEndpoints": [
          {
            "privateEndpointName": "pe-sql-[-SOLUTIONNAME-]",
            "type": "sqlServer"
          }
        ]
    },
    "sqlDatabase": {
        "name": "sqldb-[-SOLUTIONNAME-]",
        "sku": {
            "name": "Standard",
            "tier": "Standard"
        },
        "sqlAdminName": "sqlAdmin"
    },
    "appInsights": {
        "name": "ai-[-SOLUTIONNAME-]"
    },
    "keyVaults": [
        {
          "name": "cmk-st-[-SOLUTIONNAME-]",
          "privateEndpointName": "pe-cmk-st-[-SOLUTIONNAME-]",
          "privateDnsName": "privatelink-cmk-st-[-SOLUTIONNAME-].vaultcore.[-SUFFIX-]",
          "keysToCreate": [
            "cmk-main[-SOLUTIONNAME-]",
            "cmk-audit[-SOLUTIONNAME-]",
            "cmk-sql-[-SOLUTIONNAME-]",
            "cmk-internal[-SOLUTIONNAME-]"
            ]
        }
    ],
    "storage": [
        {
            "name": "audit[-SOLUTIONNAME-]",
            "sku": "Standard_LRS",
            "privateDnsName": "privatelink-staudit-[-SOLUTIONNAME-].vaultcore.[-SUFFIX-]",
            "services": [
                {
                    "type": "blob",
                    "enabled": true,
                    "privateEndpointName": "pep-st-audit-blob-[-SOLUTIONNAME-]"
                }
            ],
            "fileShares": [],
            "queues": [],
            "tables": [],
            "containers": ["insights-logs-storageread"]
        },
        {
            "name": "main[-SOLUTIONNAME-]",
            "privateDnsName": "privatelink-stmain-[-SOLUTIONNAME-].vaultcore.[-SUFFIX-]",
            "sku": "Standard_LRS",
            "services": [
                {
                    "type": "file",
                    "enabled": true,
                    "privateEndpointName": "pep-st-main-file-[-SOLUTIONNAME-]"
                },
                {
                    "type": "table",
                    "enabled": true,
                    "privateEndpointName": "pep-st-main-table-[-SOLUTIONNAME-]"

                },
                {
                    "type": "queue",
                    "enabled": true,
                    "privateEndpointName": "pep-st-main-queue-[-SOLUTIONNAME-]"
                },
                {
                    "type": "blob",
                    "enabled": true,
                    "privateEndpointName": "pep-st-main-blob-[-SOLUTIONNAME-]"
                }
            ],
            "fileShares": ["test", "func"],
            "queues": ["default", "deployarmtemplates", "status", "transfers"],
            "tables": ["default", "CompletedContainers", "transfers"],
            "containers": ["import", "completedcontainers"]
        },
        {
            "name": "internal[-SOLUTIONNAME-]",
            "privateDnsName": "privatelink-stinternal-[-SOLUTIONNAME-].vaultcore.[-SUFFIX-]",
            "sku": "Standard_LRS",
            "services": [
                {
                    "type": "table",
                    "enabled": true,
                    "privateEndpointName": "pep-st-internal-table-[-SOLUTIONNAME-]"

                },
                {
                    "type": "queue",
                    "enabled": true,
                    "privateEndpointName": "pep-st-internal-queue-[-SOLUTIONNAME-]"
                },
                {
                    "type": "blob",
                    "enabled": true,
                    "privateEndpointName": "pep-stinternal-blob-[-SOLUTIONNAME-]"
                }
            ],
            "fileShares": [],
            "queues": ["inbound-transferassignmentrequests", "inbound-transfercompilationrequests", "inbound-transferpurgerequests", "outbound-transferpurgerequests", "outboundtransferassignmentrequests"],
            "tables": ["inboundTransfers", "outboundTransfers"],
            "containers": ["azure-webjobs-hosts", "azure-webjobs-secrets"]
        }
    ],
    "bastion": {
        "name": "bastion-[-SOLUTIONNAME-]",
        "subnet": {
            "name": "AzureBastionSubnet",
            "ipAddressRange": "10.[-HUB-IP-OCTET-].0.192/26"
        }
    },
    "vms": [
        {
            "adminUsername": "adminuser",
            "name": "vm-dts",
            "subnetName": "default",
            "ipAddress": "10.[-HUB-IP-OCTET-].0.4",
            "vmSize": "Standard_DS2_v2",
            "privateDnsName": "privatelink-dts-[-SOLUTIONNAME-].vaultcore.[-SUFFIX-]",
            "privateEndpointName": "pe-vm-dts-[-SOLUTIONNAME-]",
            "dataDisks": [
                {
                    "sizeGB": 512,
                    "lun": 0
                },
                {
                    "sizeGB": 512,
                    "lun": 1
                },
                {
                    "sizeGB": 512,
                    "lun": 2
                }
            ]
        }
    ],
    "network": {
        "vnet": {
            "name": "vnet-[-SOLUTIONNAME-]",
            "addressPrefix": "10.[-HUB-IP-OCTET-].0.0/24",
            "nsgName": "nsg-[-SOLUTIONNAME-]",
            "subnets": [
                {   
                    "name" : "default",
                    "ipAddressRange": "10.[-HUB-IP-OCTET-].0.0/27",
                    "privateEndpointNetworkPolicies": "enabled",
                    "privateLinkServiceNetworkPolicies": "enabled",
                    "delegations": []
                },
                {   
                    "name": "keyvault",
                    "ipAddressRange": "10.[-HUB-IP-OCTET-].0.160/27",
                    "privateEndpointNetworkPolicies": "disabled",
                    "privateLinkServiceNetworkPolicies": "enabled",
                    "delegations": []
                },
                {   
                    "name":"webapp",
                    "ipAddressRange": "10.[-HUB-IP-OCTET-].0.32/27",
                    "privateEndpointNetworkPolicies": "disabled",
                    "privateLinkServiceNetworkPolicies": "enabled",
                    "delegations": []
                },
                {   
                    "name" : "function",
                    "ipAddressRange": "10.[-HUB-IP-OCTET-].0.64/27",
                    "privateEndpointNetworkPolicies": "disabled",
                    "privateLinkServiceNetworkPolicies": "enabled",
                    "delegations": []
                },
                {   
                    "name" : "storage",
                    "ipAddressRange": "10.[-HUB-IP-OCTET-].0.96/27",
                    "privateEndpointNetworkPolicies": "disabled",
                    "privateLinkServiceNetworkPolicies": "enabled",
                    "delegations": []
                },
                {
                    "name" : "functionintegration",
                    "ipAddressRange": "10.[-HUB-IP-OCTET-].0.128/27",
                    "privateEndpointNetworkPolicies": "enabled",
                    "privateLinkServiceNetworkPolicies": "enabled",
                    "delegations": [
                        {
                            "name": "webDelegation",
                            "properties": {
                                "serviceName": "Microsoft.Web/serverfarms"
                            }
                        }
                    ]
                },
                {
                    "name" : "AzureBastionSubnet",
                    "ipAddressRange": "10.[-HUB-IP-OCTET-].0.192/26",
                    "privateEndpointNetworkPolicies": "enabled",
                    "privateLinkServiceNetworkPolicies": "enabled",
                    "delegations": []
                }
            ],
            "nsg": []
        }
    }
}